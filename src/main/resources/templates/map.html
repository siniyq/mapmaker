<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–•–∏—Ç–º–∞–ø–∞</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap">
    <link rel="stylesheet" href="/css/styles.css">
    
    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º –Ω–æ–≤—ã–µ –º–æ–¥—É–ª—å–Ω—ã–µ JavaScript —Ñ–∞–π–ª—ã -->
    <script src="/js/modal-dialogs.js" defer></script>
    <script src="/js/route-utils.js" defer></script>
    <script src="/js/theme-manager.js" defer></script>
    <script src="/js/auth-manager.js" defer></script>
    <script src="/js/map-core.js" defer></script>
    <script src="/js/route-renderer.js" defer></script>
    <script src="/js/thematic-route-builder.js" defer></script>
    <script src="/js/heatmap.js?v=1.2" defer></script>
    <script src="/js/cultural-route.js" defer></script>
    <script src="/js/personalization.js" defer></script>
    <script src="/js/auth.js" defer></script>
</head>
<body>
    <div id="control-panel">
        <div class="theme-switcher">
            <button id="theme-toggle" class="neo-button" style="display: flex; align-items: center; justify-content: center; margin-bottom: 20px; width: 100%;">
                <span id="theme-icon">üåô</span>
                <span id="theme-text" style="margin-left: 8px;">–¢–µ–º–Ω–∞—è —Ç–µ–º–∞</span>
            </button>
        </div>

        <h3>–ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h3>
        <div id="profile-container">
            <div id="auth-container">
                <button id="login-button" class="neo-button" onclick="window.location.href='/login'">–í—Ö–æ–¥ / –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
                <p style="font-size: 0.85em; margin-top: 5px; color: #666; text-align: center;">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∫–∞—Ä—Ç—ã –∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –º–∞—Ä—à—Ä—É—Ç–æ–≤</p>
            </div>
            <div id="user-profile" style="display: none;">
                <p class="user-greeting">–ü—Ä–∏–≤–µ—Ç, <span id="user-name">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</span>!</p>
                <div class="profile-buttons">
                    <button id="saved-routes" class="neo-button">–°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã</button>
                    <button id="logout-btn" onclick="window.logout();" class="neo-button danger">–í—ã—Ö–æ–¥</button>
                </div>
            </div>
        </div>

        <h3>–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç–∞</h3>
        <p class="neo-note">–ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –∫–∞—Ä—Ç—É, —á—Ç–æ–±—ã –≤—ã–±—Ä–∞—Ç—å —Ç–æ—á–∫—É –ê, –∑–∞—Ç–µ–º —Ç–æ—á–∫—É –ë.</p>
        
        <h3>–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç</h3>
        <div id="profile-buttons">
            <button id="profile-foot" class="neo-button active">–ü–µ—à–∫–æ–º</button>
            <button id="profile-bike" class="neo-button">–í–µ–ª–æ—Å–∏–ø–µ–¥</button>
            <button id="profile-car" class="neo-button">–ê–≤—Ç–æ–º–æ–±–∏–ª—å</button>
        </div>
            
        <button id="reset-button" class="neo-button">–°–±—Ä–æ—Å–∏—Ç—å —Ç–æ—á–∫–∏</button>
        
        <h3>–¢–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –º–∞—Ä—à—Ä—É—Ç</h3>
        <p class="neo-note">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø —Ç–æ—á–µ–∫ –∏–Ω—Ç–µ—Ä–µ—Å–∞:</p>
        
        <!-- –î–æ–±–∞–≤–ª—è–µ–º –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –∫–∞—Ç–µ–≥–æ—Ä–∏–π POI -->
        <div class="neo-tabs-container">
            <div class="neo-tabs">
                <button id="category-food" class="neo-tab active">–ï–¥–∞</button>
                <button id="category-cultural" class="neo-tab">–ö—É–ª—å—Ç—É—Ä–∞</button>
            </div>
        </div>
        
        <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏—è –ï–¥–∞ -->
        <div id="poi-food-buttons" class="poi-category active">
            <div class="poi-buttons-grid">
                <button id="poi-restaurant" class="neo-button">–†–µ—Å—Ç–æ—Ä–∞–Ω—ã</button>
                <button id="poi-cafe" class="neo-button">–ö–∞—Ñ–µ</button>
                <button id="poi-bar" class="neo-button">–ë–∞—Ä—ã</button>
            </div>
        </div>
        
        <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏—è –ö—É–ª—å—Ç—É—Ä–∞ -->
        <div id="poi-cultural-buttons" class="poi-category">
            <!-- –£–¥–∞–ª—è–µ–º –∫–Ω–æ–ø–∫–∏ –∏ —Å–µ—Ç–∫—É -->
            
            <!-- –ë–ª–æ–∫ –ö—É–ª—å—Ç—É—Ä–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç -->
            <div class="cultural-route-block">
                <p class="neo-note">–ú–∞—Ä—à—Ä—É—Ç –ø–æ –∫—É–ª—å—Ç—É—Ä–Ω—ã–º –º–µ—Å—Ç–∞–º –í–∏—Ç–µ–±—Å–∫–∞</p>
                
                <div class="neo-options-group">
                    <div class="neo-checkbox-group">
                        <input type="checkbox" id="include-museum" checked>
                        <label for="include-museum">–í–∫–ª—é—á–∏—Ç—å –º—É–∑–µ–π</label>
                    </div>
                    <div class="neo-checkbox-group">
                        <input type="checkbox" id="include-park" checked>
                        <label for="include-park">–í–∫–ª—é—á–∏—Ç—å –ø–∞—Ä–∫</label>
                    </div>
                    
                    <label>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–∏–ø—ã –º–µ—Å—Ç:</label>
                    <div class="neo-checkbox-list">
                        <div class="neo-checkbox-group">
                            <input type="checkbox" id="include-theater" class="cultural-type-checkbox" value="theater" checked>
                            <label for="include-theater">–¢–µ–∞—Ç—Ä—ã</label>
                        </div>
                        <div class="neo-checkbox-group">
                            <input type="checkbox" id="include-church" class="cultural-type-checkbox" value="church" checked>
                            <label for="include-church">–¶–µ—Ä–∫–≤–∏/–°–æ–±–æ—Ä—ã</label>
                        </div>
                        <div class="neo-checkbox-group">
                            <input type="checkbox" id="include-art-gallery" class="cultural-type-checkbox" value="art_gallery" checked>
                            <label for="include-art-gallery">–ì–∞–ª–µ—Ä–µ–∏</label>
                        </div>
                        <div class="neo-checkbox-group">
                            <input type="checkbox" id="include-library" class="cultural-type-checkbox" value="library" checked>
                            <label for="include-library">–ë–∏–±–ª–∏–æ—Ç–µ–∫–∏</label>
                        </div>
                        <div class="neo-checkbox-group">
                            <input type="checkbox" id="include-attraction" class="cultural-type-checkbox" value="tourist_attraction" checked>
                            <label for="include-attraction">–î–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</label>
                        </div>
                    </div>
                </div>
                
                <div class="neo-slider">
                    <label for="cultural-poi-count">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ—á–µ–∫ (3-7):</label>
                    <div class="slider-container">
                        <input type="range" id="cultural-poi-count" min="3" max="7" value="4">
                        <span id="cultural-poi-count-value">4</span>
                    </div>
                </div>
                
                <button id="cultural-route-button" class="neo-button">–ü–æ—Å—Ç—Ä–æ–∏—Ç—å –∫—É–ª—å—Ç—É—Ä–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç</button>
            </div>
        </div>
        
        <button id="thematic-route-button" class="neo-button">–ü–æ—Å—Ç—Ä–æ–∏—Ç—å —Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –º–∞—Ä—à—Ä—É—Ç</button>
        <button id="shuffle-poi-button" class="neo-button">–ü–µ—Ä–µ–º–µ—à–∞—Ç—å —Ç–æ—á–∫–∏</button>

        <div class="neo-slider">
            <label for="poi-count-slider">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ—á–µ–∫ (3-10):</label>
            <div class="slider-container">
                <input type="range" id="poi-count-slider" min="3" max="10" value="5">
                <span id="poi-count-value">5</span>
            </div>
            <p class="neo-note">
              –¢–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –º–∞—Ä—à—Ä—É—Ç –ø—Ä–æ—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã—Ö –º–µ—Å—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ç–∏–ø–∞. 
              –° –ø–æ–º–æ—â—å—é —Å–ª–∞–π–¥–µ—Ä–∞ –º–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ—á–µ–∫ –Ω–∞ –º–∞—Ä—à—Ä—É—Ç–µ.
            </p>
        </div>

        <!-- –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —ç–ª–µ–º–µ–Ω—Ç—É -->
            </div>
            
    <div id="map-container">
        <div id="map"></div>
        
        <!-- –ë–ª–æ–∫ –ø–æ–≥–æ–¥—ã (—Å–¥–≤–∏–Ω—É—Ç –ª–µ–≤–µ–µ, —á—Ç–æ–±—ã –Ω–µ –ø–µ—Ä–µ–∫—Ä—ã–≤–∞—Ç—å—Å—è) -->
        <div id="weather-panel" style="position: absolute; right: 300px; top: 15px; z-index: 1000; padding: 10px; border-radius: 10px; background-color: rgba(var(--background-rgb), 1); box-shadow: 5px 5px 10px var(--shadow-dark), -5px -5px 10px var(--shadow-light); pointer-events: auto;">
            <div id="weather-box">
                <div class="weather-header">
                    <span id="weather-icon">‚òÄÔ∏è</span>
                    <span id="weather-temp">–ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–≥–æ–¥—ã...</span>
                </div>
                <div id="weather-description"></div>
                <div id="weather-recommendation"></div>
            </div>
            <div class="weather-controls">
                <div class="weather-tabs">
                    <button id="weather-tab-current" class="weather-tab active">–°–µ–π—á–∞—Å</button>
                    <button id="weather-tab-forecast" class="weather-tab">–ü—Ä–æ–≥–Ω–æ–∑</button>
        </div>
            </div>
        </div>
        
        <!-- –ü–∞–Ω–µ–ª—å —Ç–µ–ø–ª–æ–≤–æ–π –∫–∞—Ä—Ç—ã (—Å–ø—Ä–∞–≤–∞) -->
        <div id="heatmap-panel">
            <h3>–¢–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞</h3>
            <p style="font-size: 0.85em; margin-bottom: 10px; color: #666;">–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Ç–µ–ø–ª–æ–≤–æ–π –∫–∞—Ä—Ç–µ:</p>
            <div>
                <button id="heatmap-rating-button" class="neo-button">–ü–æ —Ä–µ–π—Ç–∏–Ω–≥—É</button>
                <button id="heatmap-density-button" class="neo-button">–ü–æ –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏</button>
                <button id="heatmap-clear-button" class="neo-button">–û—á–∏—Å—Ç–∏—Ç—å</button>
            </div>
            <div style="margin-top: 10px;">
                <select id="heatmap-type">
                    <option value="restaurant">–†–µ—Å—Ç–æ—Ä–∞–Ω—ã</option>
                    <option value="cafe">–ö–∞—Ñ–µ</option>
                    <option value="bar">–ë–∞—Ä—ã</option>
                    <option value="gym">–°–ø–æ—Ä—Ç–∑–∞–ª—ã</option>
                    <option value="pharmacy">–ê–ø—Ç–µ–∫–∏</option>
                    <option value="bank">–ë–∞–Ω–∫–∏</option>
                    <option value="school">–®–∫–æ–ª—ã</option>
                </select>
        </div>
    </div>
    
        <!-- –ë–ª–æ–∫–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –º–∞—Ä—à—Ä—É—Ç–∞—Ö (–ø–æ–¥ —Ç–µ–ø–ª–æ–≤–æ–π –∫–∞—Ä—Ç–æ–π, —Å–¥–≤–∏–Ω—É—Ç—ã –Ω–∏–∂–µ) -->
        <div id="route-info-container" style="position: absolute; right: 15px; top: 350px; z-index: 1000; width: 300px; pointer-events: none;">
            <div id="route-info" style="display: none; padding: 10px; border-radius: 10px; background-color: rgba(var(--background-rgb), 1); box-shadow: 5px 5px 10px var(--shadow-dark), -5px -5px 10px var(--shadow-light); margin-bottom: 15px; pointer-events: auto;">
                <h3>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–∞—Ä—à—Ä—É—Ç–µ</h3>
                <div class="neo-info-box">
                    <p>–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ: <span id="info-distance"></span> –∫–º</p>
                    <p>–í—Ä–µ–º—è: <span id="info-time"></span> –º–∏–Ω.</p>
                    <p>–¢–∏–ø –º–∞—Ä—à—Ä—É—Ç–∞: <span id="route-type">–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π</span></p>
                    <button id="save-route" class="neo-button success">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç</button>
                    <div id="route-description"></div>
                </div>
    </div>
    
            <div id="route-info-panel" style="display: none; padding: 10px; border-radius: 10px; background-color: rgba(var(--background-rgb), 1); box-shadow: 5px 5px 10px var(--shadow-dark), -5px -5px 10px var(--shadow-light); pointer-events: auto;">
                <h3>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–∞—Ä—à—Ä—É—Ç–µ</h3>
                <div class="neo-info-box">
                    <p>–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ: <span id="cultural-info-distance"></span> –∫–º</p>
                    <p>–í—Ä–µ–º—è: <span id="cultural-info-time"></span> –º–∏–Ω.</p>
                    <p>–¢–∏–ø –º–∞—Ä—à—Ä—É—Ç–∞: <span id="cultural-route-type" style="color: #4CAF50;">–ö—É–ª—å—Ç—É—Ä–Ω—ã–π</span></p>
                    <button id="save-cultural-route" class="neo-button success" style="background-color: #2ecc71; color: white; width: 100%; padding: 10px; margin: 10px 0; border: none; border-radius: 5px;">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç</button>
                    <div id="cultural-route-description" style="margin-top: 15px; padding: 15px; border-radius: 10px; background-color: rgba(var(--background-rgb), 1); box-shadow: inset 2px 2px 5px var(--shadow-dark), inset -2px -2px 5px var(--shadow-light); font-size: 0.9rem; max-height: 200px; overflow-y: auto;"></div>
                    </div>
                    </div>
                    </div>
                    </div>
    
    <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –¥–∏–∞–ª–æ–≥–æ–≤ -->
    <div id="neo-dialog-overlay" class="neo-dialog-overlay">
        <div id="neo-dialog" class="neo-dialog"></div>
                    </div>

    <!-- JavaScript —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –≤—ã–Ω–µ—Å–µ–Ω –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏:
         - theme-manager.js - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–º–∞–º–∏
         - auth-manager.js - –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
         - map-core.js - –æ—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –∫–∞—Ä—Ç—ã
         - route-renderer.js - –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç–æ–≤
         - thematic-route-builder.js - –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤
         - cultural-route.js - –∫—É–ª—å—Ç—É—Ä–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã
         - personalization.js - –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
         - –∏ –¥—Ä—É–≥–∏–µ –º–æ–¥—É–ª–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –≤ head
    -->

</body>
</html>

